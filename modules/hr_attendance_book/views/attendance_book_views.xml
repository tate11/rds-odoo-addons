<?xml version="1.0" encoding="utf-8"?> 
<odoo> 

<act_window 
  id="action_view_attendance_books" 
  name="Attendance Books" 
  res_model="hr.attendance.book"
  context="{'search_default_group_by_state' : True, 'search_default_active': True}"
  />

<menuitem
    id="menu_attendance_book"
    name="Attendance Books"
    action="action_view_attendance_books" 
    parent="hr_attendance.menu_hr_attendance_manage_attendances"
    sequence="0"/>


<record id="attendance_book_view_tree" model="ir.ui.view"> 
    <field name="name">attendance.book.list</field> 
    <field name="model">hr.attendance.book</field> 
    <field name="arch" type="xml"> 
        <tree>
            <field name="year"/>
            <field name="month"/>
            <field name="name"/>
            <field name="employee_id"/>
        </tree> 
    </field> 
</record>

<record id="attendance_book_view_form" model="ir.ui.view"> 
    <field name="name">attendance.book.form</field> 
    <field name="model">hr.attendance.book</field> 
    <field name="arch" type="xml"> 
        <form string="Attendance Boook">
            <header>
                <button name="load_all" type="object" string="Reload all days"/>
                <!--
                <button name="button_retry" states="partial,failed" class="btn-primary" type="object" string="Riprova"/>
                <button name="button_force" type="object" string="Forza Riinvio"/>
                <field name="state" statusbar_visible="draft" widget="statusbar"/>-->
            </header>
            <div class="oe_button_box" name="button_box">
                <button name="action_view_days" string="Open Advanced View" type="object"
                        icon="fa-plus-square"
                        help="Opens the attendance days in a dedicated view." class="oe_stat_button"/>
            </div>     
            <div class="oe_title">
                <label for="name" class="oe_edit_only"/>
                <h1>
                    <field name="name" placeholder="Nome" readonly="True"/>
                </h1>
            </div>
            <group>
                <group>
                    <field name="year"/>
                    <field name="month"/>
                    <field name="employee_id"/>
                </group>
                <group>
                </group>
            </group>
            <group>
                <field name="day_ids" nolabel="1">
                    <tree editable="bottom"
                    decoration-muted="not passed or (total_e == 0)"
                    decoration-danger="passed and (total &lt; total_e)"
                    decoration-info="passed and (total &gt; total_e) and pay_extra"
                    decoration-warning="passed and (total &gt; total_e) and not pay_extra"
                    >
                        <field name="passed" invisible="1" />
                        <field name="day" />
                        <field name="dayofweek" />
                        <field name="reason_1" />
                        <field name="qty_1" attrs="{'readonly': [('reason_1', '=', False)]}" widget="float_time"/>
                        <field name="reason_2" />
                        <field name="qty_2" attrs="{'readonly': [('reason_2', '=', False)]}" widget="float_time"/>
                        <field name="reason_3" />
                        <field name="qty_3" attrs="{'readonly': [('reason_3', '=', False)]}" widget="float_time"/>
                        <field name="reason_4" />
                        <field name="qty_4" attrs="{'readonly': [('reason_4', '=', False)]}" widget="float_time"/>
                        <field name="total" widget="float_time"/>
                        <field name="total_e" widget="float_time"/>
                        <field name="pay_extra" string="Ext." widget="toggle_button" />
                        <button name="load" type="object" icon="fa-refresh" aria-label="Reload Day" title="Reload Day"/>
                    </tree>
                </field>
            </group>
        </form> 
    </field>
</record>

<!--
*
*  Attendance Day
*
-->

<record id="attendance_day_view_tree" model="ir.ui.view"> 
    <field name="name">attendance.day.list</field> 
    <field name="model">hr.attendance.day</field> 
    <field name="arch" type="xml"> 
        <tree create="false">
            <field name="passed" invisible="1" />
            <field name="day" />
            <field name="dayofweek" />
            <field name="reason_1" />
            <field name="qty_1" widget="float_time"/>
            <field name="reason_2" />
            <field name="qty_2" widget="float_time"/>
            <field name="reason_3" />
            <field name="qty_3" widget="float_time"/>
            <field name="reason_4" />
            <field name="qty_4" widget="float_time"/>
            <field name="total" widget="float_time"/>
            <field name="total_e" widget="float_time"/>
            <field name="advantage_id" />
        </tree> 
    </field> 
</record>


<record id="attendance_day_view_form" model="ir.ui.view"> 
    <field name="name">attendance.day.form</field> 
    <field name="model">hr.attendance.day</field> 
    <field name="arch" type="xml"> 
        <form string="Attendance Boook">
            <sheet>
                <group>
                    <group>
                        <field name="date"/>
                        <field name="resource_calendar_id"/>
                        <field name="advantage_id"/>
                        <br/>
                        <field name="total" widget="float_time" class="oe_inline"/>
                        <field name="total_e" widget="float_time" class="oe_inline"/>
                    </group>
                    <group>
                        <field name="reason_1" widget="selection" class="oe_inline"/>
                        <field name="qty_1" string="Quantity 1" widget="float_time" class="oe_inline" attrs="{'invisible': [('reason_1', '=', False)]}"/>
                        <br/>
                        <field name="reason_2" widget="selection" class="oe_inline"/>
                        <field name="qty_2" string="Quantity 2" widget="float_time" class="oe_inline" attrs="{'invisible': [('reason_2', '=', False)]}"/>
                        <br/>
                        <field name="reason_3" widget="selection" class="oe_inline"/>
                        <field name="qty_3" string="Quantity 3" widget="float_time" class="oe_inline" attrs="{'invisible': [('reason_3', '=', False)]}"/>
                        <br/>
                        <field name="reason_4" widget="selection" class="oe_inline"/>
                        <field name="qty_4" string="Quantity 4" widget="float_time" class="oe_inline" attrs="{'invisible': [('reason_4', '=', False)]}"/>
                    </group>
                </group>
                <notebook>
                    <page string="Attendances">
                        <field name="attendance_ids" nolabel="1"/>
                    </page>
                    <page string="Leaves">
                        <field name="leave_ids" nolabel="1"/>
                    </page>
                    <page string="Indexes">
                        <group>
                            <group>
                                <field name="bad_markings" widget="toggle_button"/>
                                <field name="short_lateness" widget="toggle_button"/>
                                <field name="long_lateness" widget="toggle_button"/>
                                <br/>
                                <field name="unadherence_index"/>
                                <field name="absence_index"/>
                            </group>
                        </group>
                    </page>
                </notebook>
            </sheet>
        </form> 
    </field>
</record>

<!--
*
*  Attendance Type
*
-->

<record id="attendance_type_view_tree" model="ir.ui.view"> 
    <field name="name">attendance.type.list</field> 
    <field name="model">hr.attendance.type</field> 
    <field name="arch" type="xml"> 
        <tree>
            <field name="code"/>
            <field name="name"/>
            <field name="att_type"/>
        </tree> 
    </field> 
</record>


<record id="attendance_type_view_form" model="ir.ui.view"> 
    <field name="name">attendance.type.form</field> 
    <field name="model">hr.attendance.type</field> 
    <field name="arch" type="xml"> 
        <form string="Attendance Boook">
            <group>
                <group>
                    <field name="name"/>
                    <field name="att_type"/>
                </group>
                <group>
                    <field name="code"/>
                </group>
            </group>
        </form> 
    </field>
</record>

<!--
*
*  Attendance Advantage
*
-->

<record id="attendance_adv_view_tree" model="ir.ui.view"> 
    <field name="name">attendance.adv.list</field> 
    <field name="model">hr.attendance.advantage</field> 
    <field name="arch" type="xml"> 
        <tree>
            <field name="code"/>
            <field name="name"/>
        </tree> 
    </field> 
</record>


<record id="attendance_adv_view_form" model="ir.ui.view"> 
    <field name="name">attendance.adv.form</field> 
    <field name="model">hr.attendance.advantage</field> 
    <field name="arch" type="xml"> 
        <form string="Attendance Boook">
            <sheet>
                <group>
                    <group>
                        <field name="code"/>
                        <field name="name"/>
                    </group>
                </group>
                <group>
                    <field name="lines"/>
                </group>
            </sheet>
        </form> 
    </field>
</record>

<!--
*
*  Attendance Advantage Lines
*
-->

<record id="attendance_advline_view_tree" model="ir.ui.view"> 
    <field name="name">attendance.advline.list</field> 
    <field name="model">hr.attendance.advantage.line</field> 
    <field name="arch" type="xml"> 
        <tree>
            <field name="time_start" widget="float_time"/>
            <field name="time_end" widget="float_time"/>
            <field name="reason_id"/>
            <field name="reason_extra_id"/>
        </tree> 
    </field> 
</record>


<record id="attendance_advline_view_form" model="ir.ui.view"> 
    <field name="name">attendance.advline.form</field> 
    <field name="model">hr.attendance.advantage.line</field> 
    <field name="arch" type="xml"> 
        <form string="Attendance Advantage">
            <sheet>
                <group>
                    <group>
                        <field name="time_start" widget="float_time"/>
                        <field name="time_end" widget="float_time"/>
                    </group>
                    <group>
                        <field name="reason_id"/>
                        <field name="reason_extra_id"/>
                    </group>
                </group>
            </sheet>
        </form> 
    </field>
</record>

</odoo> 